/******************************************copied code */
Storage.prototype.setObject = function(key, value) {
    this.setItem(key, JSON.stringify(value));
}
Storage.prototype.getObject = function(key) {
    var value = this.getItem(key);
    return value && JSON.parse(value);
}
/***************************************** copied code end */

/****************************************** local storage*/
function getName(){var name = prompt("Please Enter Name of LinkedNote");if(name)return name;else return "Untitled LinkedNote";}
var linkedNoteMain;
if(localStorage.getObject("linkedNote")){
    linkedNoteMain=localStorage.getObject("linkedNote");
}else linkedNoteMain=new LinkedNote(getName());

window.onbeforeunload = function(event) {
    localStorage.setObject('linkedNote', linkedNoteMain); 
    
};
//set things from local storage 
window.onload = function(){
    $(".container.main").width(linkedNoteMain.docWidth);
    $(".container.main").height(linkedNoteMain.docHeight);
    $(".NoteName").html(linkedNoteMain.name);
};
/******************************************local storage end */




/******************************************definations */
function LinkedNote(name){

    this.rootsArray= [];
    this.docHeight= 500;
    this.docWidth=500;
    this.name= name;
}

function Root(x,y,name){
    this.childArray= [];
    this.name= name;
    this.x=x;
    this.y=y;
    this.notes='';
}
function Child(name){
    this.name=name;
    this.childArray=[];
    this.notes='';
    this.LinkedNote= new LinkedNote(name);
}
/******************************************definations end  */


/****************************************** adding space */
$(".rightBtn").click(function(){
    addSpace("right");
});

$(".downBtn").click(function(){
    addSpace("down");
});

function addSpace(position){
    if(position=="right"){
        $(".container.main").width($(".container.main").width()+500);
        linkedNoteMain.docWidth= $(".container.main").width();
    }else if(position =="down"){
        $(".container.main").height($(".container.main").height()+500);
        linkedNoteMain.docHeight=$(".container.main").height();
    }
    
}
/****************************************** adding space end*/




/****************************************** LinkedNote Name functions */

$("linkedNoteNameOptionsToggler").click(function(){

});

$(".linkedNoteNameInput").hide();
$(".editNameBtn").click(function(){
    $(".linkedNoteNameInput").show();
    $(".linkedNoteNameInput").val(currentLinkedNote.name);
    $(".linkedNoteNameInput").css("left","10px");
    $(".linkedNoteNameInput").focus().select();
});
$(".linkedNoteNameInput").on("keypress",function(e){
    if(e.which==13){
        currentLinkedNote.name=$(".linkedNoteNameInput").val();
        $(".linkedNoteNameInput").hide();
        $(".NoteName").html(currentLinkedNote.name);
    }
});
/******************************************LinkedNote Name functions end **/


/****************************************** start */

$(".delMainNote").click(function(){
    linkedNoteMain=new LinkedNote(getName());
    $(".container.main").width(linkedNoteMain.docWidth);
    $(".container.main").height(linkedNoteMain.docHeight);
    $(".NoteName").html(linkedNoteMain.name);
});

/****************************************** end **/

/****************************************** start*/
var currentLinkedNote=linkedNoteMain;
/****************************************** end **/


/****************************************** start*/
$(".addRootBtn").click(function(){
    var name= prompt("please Enter New Root Name");
    currentLinkedNote.rootsArray.push(new Root(0,0,name));
    displayRootsForCurrentLinkedNote();
});

function displayRootsForCurrentLinkedNote(){
    var html="";
    for(i=0;i<currentLinkedNote.rootsArray.length;i++){
        html+="<div class='root'>"+currentLinkedNote.rootsArray[i].name+"</div>";
    }
    
}
/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/
/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/
/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/
/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/
/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/
/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/

/****************************************** start*/

/******************************************end **/